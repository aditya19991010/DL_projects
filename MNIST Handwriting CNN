{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/socruz/mnist-handwriting?scriptVersionId=271907945\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"15f1b60f","metadata":{"_cell_guid":"b1076dfc-b9ad-4769-8c92-a6c4dae69d19","_uuid":"8f2839f25d086af736a60e9eeb907d3b93b6e0e5","execution":{"iopub.execute_input":"2025-10-29T19:36:31.091621Z","iopub.status.busy":"2025-10-29T19:36:31.091374Z","iopub.status.idle":"2025-10-29T19:37:17.271514Z","shell.execute_reply":"2025-10-29T19:37:17.270931Z"},"papermill":{"duration":46.184473,"end_time":"2025-10-29T19:37:17.272766","exception":false,"start_time":"2025-10-29T19:36:31.088293","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["2025-10-29 19:36:37.430189: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:477] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered\n","WARNING: All log messages before absl::InitializeLog() is called are written to STDERR\n","E0000 00:00:1761766597.663501      19 cuda_dnn.cc:8310] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered\n","E0000 00:00:1761766597.739412      19 cuda_blas.cc:1418] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered\n"]},{"name":"stdout","output_type":"stream","text":["Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/mnist.npz\n","\u001b[1m11490434/11490434\u001b[0m \u001b[32m━━━━━━━━━━━━━━━━━━━━\u001b[0m\u001b[37m\u001b[0m \u001b[1m1s\u001b[0m 0us/step\n","X_train: (60000, 28, 28)\n","y_train: (60000,)\n","X_test: (10000, 28, 28)\n","y_test: (10000,)\n","\n","Convert data to tensor\n","\n","Convert tensor to tensor dataset\n","\n","Data loaded successfully\n","Starting training with 5 epochs... \n","\n","Train Accuracy: 0.9414833333333333\n","\n","Test Accuracy: 0.9805\n","\n","\tEpoch 0\n","Train loss: \t0.2815256099954351\n","Test loss: \t0.06343690314846244\n","\n","Epoch 0\n","Train loss at Epoch 0 = 0.2815256099954351\n","Test loss at Epoch 0 = 0.06343690314846244\n","\n","Train Accuracy: 0.9774\n","\n","Test Accuracy: 0.9865\n","\n","\tEpoch 1\n","Train loss: \t0.0781868640185723\n","Test loss: \t0.04116327061123588\n","\n","Train Accuracy: 0.9805166666666667\n","\n","Test Accuracy: 0.9878\n","\n","\tEpoch 2\n","Train loss: \t0.06485241352026212\n","Test loss: \t0.03843551374168082\n","\n","Train Accuracy: 0.9817166666666667\n","\n","Test Accuracy: 0.9846\n","\n","\tEpoch 3\n","Train loss: \t0.06336457223098016\n","Test loss: \t0.056617002323222386\n","\n","Train Accuracy: 0.9832833333333333\n","\n","Test Accuracy: 0.9866\n","\n","\tEpoch 4\n","Train loss: \t0.05923031224303994\n","Test loss: \t0.040844602669755314\n"]},{"data":{"image/png":"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EbXLwGdlZcHb21vi3hAREVFLaLVahIeHG3+PN4cBqBG1017e3t4MQERERHamJeUrLIImIiIip8MARERERE6HAYiIiIicDmuAiIiIrMhgMECn00ndDbvk6uoKhUJhkXMxABEREVmJTqfD5cuXYTAYpO6K3fLx8UFwcHC71+ljACIiIrICQRCQk5MDhUKB8PDw2y7UR+YEQUBZWRny8/MBACEhIe06HwMQERGRFVRXV6OsrAyhoaFwd3eXujt2yc3NDQCQn5+PwMDAdk2HMX4SERFZgV6vBwAolUqJe2LfasNjVVVVu87DAERERGRFfMZk+1jqz48BiIiIiJwOAxARERFZRWRkJFauXCl1NwCwCJqIiIiaMWLECAwYMMAiweXIkSPw8PBof6csgCNAVnY2V4s8bYXU3SAiIrIIQRBQXV3dorYBAQE2cwccA5AVvfr1Lxi98ges/+mK1F0hIiK6renTp2P//v145513IJPJIJPJsH79eshkMnz77beIi4uDSqXCjz/+iIsXL+LBBx9EUFAQPD09ER8fjz179pidr/4UmEwmwwcffICHHnoI7u7uiI6OxldffWWVa2MAsqLBkb4AgK1Hs6Cr5iqgRETOTBAElOmqJdkEQWhRH9955x0MGTIETz75JHJycpCTk4Pw8HAAwPz587Fs2TKcOXMGsbGxKCkpwdixY5Gamor09HSMHj0a48aNw9WrV5t9j8WLF2PChAk4efIkxo4di8ceewy3bt1q95/v7bAGyIpG9g5CgJcKN4orsedMHsbGtG8VSyIisl/lVXr0eXmnJO/9y5JkuCtvHwE0Gg2USiXc3d0RHBwMADh79iwAYMmSJbjvvvuMbf38/NC/f3/j96+88gq2bduGr776CrNnz27yPaZPn47JkycDAF5//XW8++67SEtLw+jRo9t0bS3FESArclXIMWFwGABg4+HmEzEREZEtGzx4sNn3JSUlmDdvHnr37g0fHx94enrizJkztx0Bio2NNX7t4eEBb29v4+MuOhJHgKxsUnwX/O++i/jxQgEyb5YiopNtVMMTEZF1ubkq8MuSZMneu73q3801b9487N69GytWrED37t3h5uaGRx55BDqdrtnzuLq6mn0vk8ms8rBYBiArC/dzx93RAdj/6w1sSsvC/DG9pO4SERFJQCaTtWgaSmpKpdL4GI/mHDhwANOnT8dD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AGafiT3/DLbl+uztZ/APf/iDEBERISiVSiEgIEAYOXKkMRwIgn1/foLQ+uuzt8+vMfUDkK18hjJBEISOHWMiIiIisi2sASIiIiKnwwBERERETocBiIiIiJwOAxARERE5HQYgIiIicjoMQEREROR0GICIiIjI6TAAERG1gEwmw/bt26XuBhFZCAMQEdm86dOnQyaTNdhGjx4tddeIyE7xafBEZBdGjx6Njz76yGyfSqWSqDdEZO84AkREdkGlUiE4ONhs8/X1BSBOT61duxZjxoyBm5sbunXrhs8++8zs+FOnTuHee++Fm5sbOnXqhKeeegolJSVmbT788EP07dsXKpUKISEhmD17ttnrBQUFeOihh+Du7o7o6Gh89dVXHXvRRNRhGICIyCG89NJLGD9+PE6cOIHHHnsMkyZNwpkzZwAApaWlSE5Ohq+vL44cOYKtW7diz549ZgFn7dq1mDVrFp566imcOnUKX331Fbp37272HosXL8aECRNw8uRJjB07Fo899hhu3bpl1eskIgvp8MetEhG107Rp0wSFQiF4eHiYba+99pogCOJT0p955hmzYxITE4WZM2cKgiAI//znPwVfX1+hpKTE+Pp///tfQS6XC7m5uYIgCEJoaKjw97//vck+ABBefPFF4/clJSUCAOHbb7+12HUSkfWwBoiI7MI999yDtWvXmu3z8/Mzfj1kyBCz14YMGYKMjAwAwJkzZ9C/f394eHgYX7/zzjthMBhw7tw5yGQyXL9+HSNHjmy2D7GxscavPTw84O3tjfz8/LZeEhFJiAGIiOyCh4dHgykpS3Fzc2tRO1dXV7PvZTIZDAZDR3SJiDoYa4CIyCEcOnSowfe9e/cGAPTu3RsnTpxAaWmp8fUDBw5ALpejZ8+e8PLyQmRkJFJTU63aZyKSDkeAiMguVFZWIjc312yfi4sL/P39AQBbt27F4MGDcdddd+GTTz5BWloa/u///g8A8Nhjj2HhwoWYNm0aFi1ahBs3buC5557D448/jqCgIADAokWL8MwzzyAwMBBjxoxBcXExDhw4gOeee866F0pEVsEARER2YceOHQgJCTHb17NnT5w9exaAeIfW5s2b8eyzzyIkJASbNm1Cnz59AADu7u7YuXMnnn/+ecTHx8Pd3R3jx4/HW2+9ZTzXtGnTUFFRgbfffhvz5s2Dv78/HnnkEetdIBFZlUwQBEHqThARtYdMJsO2bduQkpIidVeIyE6wBoiIiIicDgMQEREROR3WABGR3eNMPhG1FkeAiIiIyOkwABEREZHTYQAiIiIip8MARERERE6HAYiIiIicDgMQEREROR0GICIiInI6DEBERETkdBiAiIiIyOn8P6wAx5JGyO3/AAAAAElFTkSuQmCC\n","text/plain":["<Figure size 640x480 with 1 Axes>"]},"metadata":{},"output_type":"display_data"}],"source":["## Training MNIST handwriting data\n","import matplotlib.pyplot as plt\n","import torch\n","from tensorflow.keras.datasets import mnist\n","from torch import nn\n","from torch.utils.data import DataLoader, TensorDataset\n","from torchvision import transforms\n","import numpy as np\n","\n","device = torch.device(\"cuda\")\n","\n","## Model \n","class CNN(nn.Module):\n","    def __init__(self, op=10):\n","        super(CNN, self).__init__()\n","\n","        self.features = nn.Sequential(\n","            nn.Conv2d(1, 32, kernel_size=3, padding=1),  # 1x28x28 -> 32x28x28\n","            nn.BatchNorm2d(32),\n","            nn.ReLU(inplace=True),\n","            nn.MaxPool2d(2, 2),                         # 32x14x14\n","\n","            nn.Conv2d(32, 64, kernel_size=3, padding=1), # 64x14x14\n","            nn.BatchNorm2d(64),\n","            nn.ReLU(inplace=True),\n","        )\n","\n","        self.classifier = nn.Sequential(\n","            nn.Dropout(0.5),\n","            nn.Linear(64*14*14, 128),\n","            nn.ReLU(),\n","            nn.Linear(128, op)\n","        )\n","\n","    def forward(self, x):\n","        x = self.features(x)\n","        x = torch.flatten(x,1)\n","        x = self.classifier(x)\n","        return x\n","\n","\n","## Training loop\n","def training_loop(dataloader,loss_func, optim, model):\n","    model.train()\n","    tot_loss = 0\n","    correct=0\n","    # iterate through each batch of the dataloader\n","    # print(f'Training model...')\n","    for X_train, y_train in dataloader:\n","\n","        # move the data into the device (gpu/cpu)\n","        X_train, y_train = X_train.to(device), y_train.to(device)\n","\n","        ## predict --> calc loss --> set grad to 0 --> perf bwd prop --> perform optimization for updating model wghts\n","\n","        pred = model(X_train)\n","        loss = loss_func(pred, y_train)\n","\n","        optim.zero_grad()\n","        loss.backward()\n","        optim.step()\n","        _,predicted = pred.max(1)\n","        correct += predicted.eq(y_train).sum().item()\n","\n","        tot_loss +=loss.item()\n","    # print(f'\\nCalculating loss...')\n","    ave_loss = tot_loss/len(dataloader)\n","    print(f'\\nTrain Accuracy: {correct/len(dataloader.dataset)}')\n","\n","    return ave_loss\n","\n","def eval_loop(model, loss_fn, dataloader):\n","    model.eval()\n","    tot_loss = 0\n","    correct =0\n","    # print(f'\\nEvaluating model...')\n","    for X_test, y_test in dataloader:\n","        X_test, y_test = X_test.to(device), y_test.to(device)\n","\n","        pred = model(X_test)\n","        loss = loss_fn(pred, y_test)\n","        _,predicted = pred.max(1)\n","        correct += predicted.eq(y_test).sum().item()\n","        tot_loss +=loss.item()\n","\n","    # print(f'\\nCalculating loss...')\n","    ave_loss = tot_loss/len(dataloader)\n","    print(f'\\nTest Accuracy: {correct/len(dataloader.dataset)}')\n","    return ave_loss\n","\n","\n","def main():\n","  # Import data\n","  df = mnist.load_data()\n","\n","  (X_train, y_train), (X_test, y_test) =  df\n","  data = [X_train, y_train ,X_test, y_test]\n","\n","  # Data preprocessing\n","  print('X_train:', X_train.shape)\n","  print('y_train:', y_train.shape)\n","  print('X_test:', X_test.shape)\n","  print('y_test:', y_test.shape)\n","\n","  # Data standardatization\n","\n","  torch.manual_seed(42)\n","\n","  ## Convert np to tensor and reshaping the size\n","  X_train_ten = torch.tensor(X_train, dtype=torch.float32).unsqueeze(1) / 255.0  # -> (60000, 1, 28, 28)\n","  X_test_ten  = torch.tensor(X_test, dtype=torch.float32).unsqueeze(1) / 255.0   # -> (10000, 1, 28, 28)\n","  y_train_ten = torch.tensor(y_train, dtype=torch.long)\n","  y_test_ten  = torch.tensor(y_test, dtype=torch.long)\n","\n","  print('\\nConvert data to tensor')\n","\n","  ## transform data\n","  transform = transforms.Normalize(mean=[0.5], std=[0.5])\n","  X_train_ten = transform(X_train_ten)\n","  X_test_ten = transform(X_test_ten)\n","\n","\n","  ## Convert tensor to tensor dataset\n","  train_df = TensorDataset(X_train_ten, y_train_ten)\n","  test_df = TensorDataset(X_test_ten, y_test_ten)\n","  print('\\nConvert tensor to tensor dataset')\n","\n","\n","  ## Data loading\n","  train_load = DataLoader(train_df,batch_size=64, shuffle=True)\n","  test_load = DataLoader(test_df,batch_size=64, shuffle=True)\n","  print('\\nData loaded successfully')\n","\n","\n","  ## Set up models\n","  model = CNN(op=10).to(device).to(torch.float64)\n","\n","\n","  ## Set model hyper param\n","  l,n,m = X_train.shape\n","  p = y_train.shape[0]\n","  lr = 0.01\n","  batch = 64\n","  epoch=5\n","\n","  loss_func = nn.CrossEntropyLoss()\n","  optim=torch.optim.Adam(model.parameters(), lr)\n","\n","  model = model.to(torch.float32)\n","  ## Training with multiple epoch\n","\n","  train_loss_tot = []\n","  test_loss_tot = []\n","\n","  print(f\"Starting training with {epoch} epochs... \")\n","  for i in range(epoch):\n","      tr_loss = training_loop(train_load, loss_func, optim, model)\n","      te_loss = eval_loop(model,loss_func,test_load)\n","\n","      train_loss_tot.append(tr_loss)\n","      test_loss_tot.append(te_loss)\n","      print(f\"\\n\\tEpoch {i}\")\n","      print(f\"Train loss: \\t{tr_loss}\")\n","      print(f\"Test loss: \\t{te_loss}\")\n","\n","      if i%100==0:\n","          print(f\"\\nEpoch {i}\")\n","          print(f\"Train loss at Epoch {i} = {np.mean(train_loss_tot)}\")\n","          print(f\"Test loss at Epoch {i} = {np.mean(test_loss_tot)}\")\n","\n","\n","\n","  plt.plot(train_loss_tot, label='train')\n","  plt.plot(test_loss_tot, label='test')\n","  plt.legend()\n","  plt.xlabel(\"Epoch\")\n","  plt.ylabel('Loss')\n","  plt.title('Training and Test Loss')\n","  plt.show()\n","\n","if __name__ == \"__main__\":\n","    main()"]},{"cell_type":"code","execution_count":null,"id":"567ef1de","metadata":{"papermill":{"duration":0.002614,"end_time":"2025-10-29T19:37:17.278788","exception":false,"start_time":"2025-10-29T19:37:17.276174","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[],"dockerImageVersionId":31153,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.11.13"},"papermill":{"default_parameters":{},"duration":53.107336,"end_time":"2025-10-29T19:37:20.118463","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-10-29T19:36:27.011127","version":"2.6.0"}},"nbformat":4,"nbformat_minor":5}